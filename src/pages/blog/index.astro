---
import MainLayout from '../../layouts/MainLayout.astro';
import Post from '../../components/Post.astro';

import { config } from '../../data/siteConfig';

const posts = await Astro.glob('./*/**.md');
let publishedPosts = posts.filter((post) => !post?.frontmatter?.draft);

publishedPosts = publishedPosts.sort((a, b) => {
  return (
    (new Date(b?.frontmatter?.date) as unknown as number) -
    (new Date(a?.frontmatter?.date) as unknown as number)
  );
});

// publishedPosts.map((matt) => console.log(matt.frontmatter.title));
// posts.filter((post) => console.log(post.frontmatter.title));
---

<MainLayout
  title={`Home - ${config.siteTitle} | Software Developer and Open Source Enthusiast`}
>
  <div class="py-10 mx-auto container-inner">
    <h1 class="mb-2 text-5xl font-bold">Articles</h1>
    <p class="mb-6 text-xl">
      Up to date Posts, tutorials, explanations, snippets, thoughts, musings,
      and everything else.
    </p>

    <div class="flex justify-center mb-8">
      <div class="relative w-full">
        <input
          type="text"
          aria-label="Search"
          id="search-form"
          placeholder="Type to filter posts..."
          class="w-full px-4 py-2 pl-10 border border-gray-500 rounded-full outline-none bg-background-form focus:border-green-500"
        />
        <div class="absolute top-0 ml-3" style={{ top: `${10}px` }}>
          <svg
            fill="currentColor"
            class="w-5 h-5 text-gray-500"
            viewBox="0 0 24 24"
            width="24"
            height="24"
          >
            <path
              class="heroicon-ui"
              d="M16.32 14.9l5.39 5.4a1 1 0 0 1-1.42 1.4l-5.38-5.38a8 8 0 1 1 1.41-1.41zM10 16a6 6 0 1 0 0-12 6 6 0 0 0 0 12z"
            ></path>
          </svg>
        </div>
        <!-- {
          query.length > 0 ? (
            <div
              onClick={() => setState({ query: '' })}
              class="absolute top-0 right-0 mr-3 text-2xl text-gray-400 cursor-pointer hover:text-gray-700"
              style={{ top: `${2}px` }}
            >
              &times;
            </div>
          ) : null
        } -->
      </div>

      <div class="self-center ml-2 text-sm">
        <p
          class="px-4 py-2 mr-4 font-medium text-white bg-gray-600 rounded-full hover:bg-green-600"
        >
          {publishedPosts.length}
        </p>
      </div>
    </div>

    {publishedPosts.map((post) => <Post post={post.frontmatter} />)}
  </div>
</MainLayout>

<!-- <script define:vars={{ posts }}> -->
<script>
  //   let searchForm = document.querySelector<HTMLElement>('#search-form');

  //   //   searchForm.addEventListener('submit', handleSubmit);
  //   searchForm.addEventListener('keyup', function (e) {
  //     console.log(e.target.value);
  //     // console.log(posts);
  //   });
</script>
